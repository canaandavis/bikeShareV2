function _isStackIndex(e){return/^[\-+]\d+$/.test(e)}function _parseStackIndex(e){if(_isStackIndex(e)){if(Math.abs(e)<_dirStack.length+1)return/^-/.test(e)?Number(e)-1:Number(e);common.error(e+": directory stack index out of range")}else common.error(e+": invalid number")}function _actualDirStack(){return[process.cwd()].concat(_dirStack)}function _pushd(e,t){_isStackIndex(e)&&(t=e,e=""),e=common.parseOptions(e,{n:"no-cd"});var n=_actualDirStack();if(t==="+0")return n;if(!t){if(!(n.length>1))return common.error("no other directory");n=n.splice(1,1).concat(n)}else if(_isStackIndex(t)){var r=_parseStackIndex(t);n=n.slice(r).concat(n.slice(0,r))}else e["no-cd"]?n.splice(1,0,t):n.unshift(t);return e["no-cd"]?n=n.slice(1):(t=path.resolve(n.shift()),_cd("",t)),_dirStack=n,_dirs("")}function _popd(e,t){_isStackIndex(e)&&(t=e,e=""),e=common.parseOptions(e,{n:"no-cd"});if(!_dirStack.length)return common.error("directory stack empty");t=_parseStackIndex(t||"+0");if(e["no-cd"]||t>0||_dirStack.length+t===0)t=t>0?t-1:t,_dirStack.splice(t,1);else{var n=path.resolve(_dirStack.shift());_cd("",n)}return _dirs("")}function _dirs(e,t){_isStackIndex(e)&&(t=e,e=""),e=common.parseOptions(e,{c:"clear"});if(e.clear)return _dirStack=[],_dirStack;var n=_actualDirStack();return t?(t=_parseStackIndex(t),t<0&&(t=n.length+t),common.log(n[t]),n[t]):(common.log(n.join(" ")),n)}var common=require("./common"),_cd=require("./cd"),path=require("path"),_dirStack=[];exports.pushd=_pushd,exports.popd=_popd,exports.dirs=_dirs;