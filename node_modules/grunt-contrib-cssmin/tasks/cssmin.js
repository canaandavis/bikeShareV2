/*
 * grunt-contrib-cssmin
 * http://gruntjs.com/
 *
 * Copyright (c) 2014 Tim Branyen, contributors
 * Licensed under the MIT license.
 */

var path=require("path"),CleanCSS=require("clean-css"),chalk=require("chalk"),maxmin=require("maxmin");module.exports=function(e){var t=function(t,n){try{return(new CleanCSS(n)).minify(t)}catch(r){e.log.error(r),e.fail.warn("CSS minification failed.")}};e.registerMultiTask("cssmin","Minify CSS",function(){var n=this.options({report:"min"});this.files.forEach(function(r){var i=r.src.filter(function(t){return e.file.exists(t)?!0:(e.log.warn("Source file "+chalk.cyan(t)+" not found."),!1)}),s="",o=i.map(function(r){var i=e.file.read(r);return s+=i,n.relativeTo=path.dirname(r),t(i,n)}).join("");if(o.length===0)return e.log.warn("Destination not written because minified CSS was empty.");n.banner&&(o=n.banner+e.util.linefeed+o),e.file.write(r.dest,o),e.log.writeln("File "+chalk.cyan(r.dest)+" created: "+maxmin(s,o,n.report==="gzip"))})})};