function a2s(e){return String.fromCharCode.apply(null,e)}var fs=require("fs"),path=require("path"),assert=require("assert"),pako_utils=require("../lib/utils/common"),pako=require("../index"),cmp=require("./helpers").cmpBuf;describe("Gzip special cases",function(){it("Read custom headers",function(){var e=fs.readFileSync(path.join(__dirname,"fixtures/gzip-headers.gz")),t=new pako.Inflate;t.push(e,!0),assert.equal(t.header.name,"test name"),assert.equal(t.header.comment,"test comment"),assert.equal(a2s(t.header.extra),"test extra")}),it("Write custom headers",function(){var e="           ",t=new pako.Deflate({gzip:!0,header:{hcrc:!0,time:1234567,os:15,name:"test name",comment:"test comment",extra:[4,5,6]}});t.push(e,!0);var n=new pako.Inflate({to:"string"});n.push(t.result,!0),assert.equal(n.err,0),assert.equal(n.result,e);var r=n.header;assert.equal(r.time,1234567),assert.equal(r.os,15),assert.equal(r.name,"test name"),assert.equal(r.comment,"test comment"),assert(cmp(r.extra,[4,5,6]))}),it("Read stream with SYNC marks",function(){var e,t,n,r,i=0,s=0,o=fs.readFileSync(path.join(__dirname,"fixtures/gzip-joined.gz"));do r=o.length-i,n=new pako_utils.Buf8(r),pako_utils.arraySet(n,o,i,r,0),e=new pako.Inflate,t=e.strm,e.push(n,!0),assert(!e.err,e.msg),i+=t.next_in,s++;while(t.avail_in);assert(s===2,"invalid blobs count")})});