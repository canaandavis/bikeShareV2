var BAD=30,TYPE=12;module.exports=function(t,n){var r,i,s,o,u,a,f,l,c,h,p,d,v,m,g,y,b,w,E,S,x,T,N,C,k;r=t.state,i=t.next_in,C=t.input,s=i+(t.avail_in-5),o=t.next_out,k=t.output,u=o-(n-t.avail_out),a=o+(t.avail_out-257),f=r.dmax,l=r.wsize,c=r.whave,h=r.wnext,p=r.window,d=r.hold,v=r.bits,m=r.lencode,g=r.distcode,y=(1<<r.lenbits)-1,b=(1<<r.distbits)-1;e:do{v<15&&(d+=C[i++]<<v,v+=8,d+=C[i++]<<v,v+=8),w=m[d&y];t:for(;;){E=w>>>24,d>>>=E,v-=E,E=w>>>16&255;if(E===0)k[o++]=w&65535;else{if(!(E&16)){if((E&64)===0){w=m[(w&65535)+(d&(1<<E)-1)];continue t}if(E&32){r.mode=TYPE;break e}t.msg="invalid literal/length code",r.mode=BAD;break e}S=w&65535,E&=15,E&&(v<E&&(d+=C[i++]<<v,v+=8),S+=d&(1<<E)-1,d>>>=E,v-=E),v<15&&(d+=C[i++]<<v,v+=8,d+=C[i++]<<v,v+=8),w=g[d&b];n:for(;;){E=w>>>24,d>>>=E,v-=E,E=w>>>16&255;if(!(E&16)){if((E&64)===0){w=g[(w&65535)+(d&(1<<E)-1)];continue n}t.msg="invalid distance code",r.mode=BAD;break e}x=w&65535,E&=15,v<E&&(d+=C[i++]<<v,v+=8,v<E&&(d+=C[i++]<<v,v+=8)),x+=d&(1<<E)-1;if(x>f){t.msg="invalid distance too far back",r.mode=BAD;break e}d>>>=E,v-=E,E=o-u;if(x>E){E=x-E;if(E>c&&r.sane){t.msg="invalid distance too far back",r.mode=BAD;break e}T=0,N=p;if(h===0){T+=l-E;if(E<S){S-=E;do k[o++]=p[T++];while(--E);T=o-x,N=k}}else if(h<E){T+=l+h-E,E-=h;if(E<S){S-=E;do k[o++]=p[T++];while(--E);T=0;if(h<S){E=h,S-=E;do k[o++]=p[T++];while(--E);T=o-x,N=k}}}else{T+=h-E;if(E<S){S-=E;do k[o++]=p[T++];while(--E);T=o-x,N=k}}while(S>2)k[o++]=N[T++],k[o++]=N[T++],k[o++]=N[T++],S-=3;S&&(k[o++]=N[T++],S>1&&(k[o++]=N[T++]))}else{T=o-x;do k[o++]=k[T++],k[o++]=k[T++],k[o++]=k[T++],S-=3;while(S>2);S&&(k[o++]=k[T++],S>1&&(k[o++]=k[T++]))}break}}break}}while(i<s&&o<a);S=v>>3,i-=S,v-=S<<3,d&=(1<<v)-1,t.next_in=i,t.next_out=o,t.avail_in=i<s?5+(s-i):5-(i-s),t.avail_out=o<a?257+(a-o):257-(o-a),r.hold=d,r.bits=v;return};