function loadSamples(e){var t={},n=path.join(__dirname,"fixtures",e||"samples");return fs.readdirSync(n).sort().forEach(function(e){var r=path.join(n,e),i=path.extname(r),s=path.basename(r,i),o=new Uint8Array(fs.readFileSync(r));if(s[0]==="_")return;t[s]=o}),t}function cmpBuf(e,t){if(e.length!==t.length)return!1;for(var n=0,r=e.length;n<r;n++)if(e[n]!==t[n])return!1;return!0}function testSingle(e,t,n,r,i){var s=_.clone(r);s.windowBits<0&&(s.windowBits=-s.windowBits);var o=e(s),u=[],a=0;o.on("error",function(e){o.removeAllListeners(),o=null,i(e)}),o.on("data",function(e){u.push(e),a+=e.length}),o.on("end",function(){o.removeAllListeners(),o=null;var e=Buffer.concat(u),s=t(n,r);if(!cmpBuf(e,s)){i(new Error("zlib result != pako result"));return}i(null)}),o.write(new Buffer(n)),o.end()}function testSamples(e,t,n,r,i){var s=[];_.forEach(n,function(n,i){s.push(function(s){pako_utils.setTyped(!1),testSingle(e,t,n,r,function(e){if(e){s('Error in "'+i+'" - zlib result != pako result');return}s()})}),s.push(function(s){pako_utils.setTyped(!0),testSingle(e,t,n,r,function(e){if(e){s('Error in "'+i+'" - zlib result != pako result');return}s()})})}),async.series(s,i)}function testInflate(e,t,n,r){var i,s,o,u;for(i in e){s=e[i],pako_utils.setTyped(!0),o=pako.deflate(s,n),pako_utils.setTyped(!1),u=pako.inflate(o,t),pako_utils.setTyped(!0);if(!cmpBuf(u,s)){r('Error in "'+i+'" - inflate result != original');return}u=pako.inflate(o,t);if(!cmpBuf(u,s)){r('Error in "'+i+'" - inflate result != original');return}}r()}var fs=require("fs"),path=require("path"),_=require("lodash"),async=require("async"),pako_utils=require("../lib/utils/common"),pako=require("../index");exports.cmpBuf=cmpBuf,exports.testSamples=testSamples,exports.testInflate=testInflate,exports.loadSamples=loadSamples;