function inflate(e,t){var n=new Inflate(t);n.push(e,!0);if(n.err)throw n.msg;return n.result}function inflateRaw(e,t){return t=t||{},t.raw=!0,inflate(e,t)}var zlib_inflate=require("./zlib/inflate.js"),utils=require("./utils/common"),strings=require("./utils/strings"),c=require("./zlib/constants"),msg=require("./zlib/messages"),zstream=require("./zlib/zstream"),gzheader=require("./zlib/gzheader"),Inflate=function(e){this.options=utils.assign({chunkSize:16384,windowBits:0,to:""},e||{});var t=this.options;t.raw&&t.windowBits>=0&&t.windowBits<16&&(t.windowBits=-t.windowBits,t.windowBits===0&&(t.windowBits=-15)),t.windowBits>=0&&t.windowBits<16&&(!e||!e.windowBits)&&(t.windowBits+=32),t.windowBits>15&&t.windowBits<48&&(t.windowBits&15)===0&&(t.windowBits|=15),this.err=0,this.msg="",this.ended=!1,this.chunks=[],this.strm=new zstream,this.strm.avail_out=0;var n=zlib_inflate.inflateInit2(this.strm,t.windowBits);if(n!==c.Z_OK)throw new Error(msg[n]);this.header=new gzheader,zlib_inflate.inflateGetHeader(this.strm,this.header)};Inflate.prototype.push=function(e,t){var n=this.strm,r=this.options.chunkSize,i,s,o,u,a;if(this.ended)return!1;s=t===~~t?t:t===!0?c.Z_FINISH:c.Z_NO_FLUSH,typeof e=="string"?n.input=strings.binstring2buf(e):n.input=e,n.next_in=0,n.avail_in=n.input.length;do{n.avail_out===0&&(n.output=new utils.Buf8(r),n.next_out=0,n.avail_out=r),i=zlib_inflate.inflate(n,c.Z_NO_FLUSH);if(i!==c.Z_STREAM_END&&i!==c.Z_OK)return this.onEnd(i),this.ended=!0,!1;n.next_out&&(n.avail_out===0||i===c.Z_STREAM_END||n.avail_in===0&&s===c.Z_FINISH)&&(this.options.to==="string"?(o=strings.utf8border(n.output,n.next_out),u=n.next_out-o,a=strings.buf2string(n.output,o),n.next_out=u,n.avail_out=r-u,u&&utils.arraySet(n.output,n.output,o,u,0),this.onData(a)):this.onData(utils.shrinkBuf(n.output,n.next_out)))}while(n.avail_in>0&&i!==c.Z_STREAM_END);return i===c.Z_STREAM_END&&(s=c.Z_FINISH),s===c.Z_FINISH?(i=zlib_inflate.inflateEnd(this.strm),this.onEnd(i),this.ended=!0,i===c.Z_OK):!0},Inflate.prototype.onData=function(e){this.chunks.push(e)},Inflate.prototype.onEnd=function(e){e===c.Z_OK&&(this.options.to==="string"?this.result=this.chunks.join(""):this.result=utils.flattenChunks(this.chunks)),this.chunks=[],this.err=e,this.msg=this.strm.msg},exports.Inflate=Inflate,exports.inflate=inflate,exports.inflateRaw=inflateRaw,exports.ungzip=inflate;