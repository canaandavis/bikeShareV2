function testDeflate(e,t,n){var r=new pako.Deflate(t);r.push(e,n),r.push(e,!0),assert.equal(r.err,!1,msg[r.err])}var assert=require("assert"),fs=require("fs"),path=require("path"),c=require("../lib/zlib/constants"),msg=require("../lib/zlib/messages"),zlib_deflate=require("../lib/zlib/deflate.js"),zstream=require("../lib/zlib/zstream"),pako=require("../index"),short_sample="hello world",long_sample=fs.readFileSync(path.join(__dirname,"fixtures/samples/lorem_en_100k.txt"));describe("Deflate support",function(){it("stored",function(){testDeflate(short_sample,{level:0,chunkSize:200},0),testDeflate(short_sample,{level:0,chunkSize:10},5)}),it("fast",function(){testDeflate(short_sample,{level:1,chunkSize:10},5),testDeflate(long_sample,{level:1,memLevel:1,chunkSize:10},0)}),it("slow",function(){testDeflate(short_sample,{level:4,chunkSize:10},5),testDeflate(long_sample,{level:9,memLevel:1,chunkSize:10},0)}),it("rle",function(){testDeflate(short_sample,{strategy:3},0),testDeflate(short_sample,{strategy:3,chunkSize:10},5),testDeflate(long_sample,{strategy:3,chunkSize:10},0)}),it("huffman",function(){testDeflate(short_sample,{strategy:2},0),testDeflate(short_sample,{strategy:2,chunkSize:10},5),testDeflate(long_sample,{strategy:2,chunkSize:10},0)})}),describe("Deflate states",function(){it("inflate bad parameters",function(){var e,t;e=zlib_deflate.deflate(null,0),assert(e===c.Z_STREAM_ERROR),t=new zstream,e=zlib_deflate.deflateInit(null),assert(e===c.Z_STREAM_ERROR),e=zlib_deflate.deflateInit(t,6),assert(e===c.Z_OK),e=zlib_deflate.deflateSetHeader(null),assert(e===c.Z_STREAM_ERROR),t.state.wrap=1,e=zlib_deflate.deflateSetHeader(t,null),assert(e===c.Z_STREAM_ERROR),t.state.wrap=2,e=zlib_deflate.deflateSetHeader(t,null),assert(e===c.Z_OK),e=zlib_deflate.deflate(t,c.Z_FINISH),assert(e===c.Z_BUF_ERROR),e=zlib_deflate.deflateEnd(null),assert(e===c.Z_STREAM_ERROR),t.state.status=5,e=zlib_deflate.deflateEnd(t),assert(e===c.Z_STREAM_ERROR)})});