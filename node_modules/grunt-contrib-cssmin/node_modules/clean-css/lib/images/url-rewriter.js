var path=require("path"),url=require("url");module.exports={process:function(e,t){var n=[],r=0,i=0,s=0;for(;i<e.length;){r=e.indexOf("url(",i);if(r==-1)break;i=e.indexOf(")",r+4);if(i==-1)break;n.push(e.substring(s,r));var o=e.substring(r+4,i);/\/\*|\*\//.test(o)||(o=o.replace(/['"]/g,"")),n.push("url("+this._rebased(o,t)+")"),s=i+1}return n.length>0?n.join("")+e.substring(s,e.length):e},_rebased:function(e,t){var n=e[0]=="/"||e.substring(e.length-4)==".css"||e.indexOf("data:")===0||/^https?:\/\//.exec(e)!==null||/__\w+__/.exec(e)!==null,r;return n?e:/https?:\/\//.test(t.toBase)?url.resolve(t.toBase,e):(t.absolute?r=path.resolve(path.join(t.fromBase,e)).replace(t.toBase,""):r=path.relative(t.toBase,path.join(t.fromBase,e)),process.platform=="win32"?r.replace(/\\/g,"/"):r)}};